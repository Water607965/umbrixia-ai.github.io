<!DOCTYPE html>
 <html lang="en">
 <head>
   <meta charset="UTF-8" />
   <meta name="viewport" content="width=device-width, initial-scale=1.0" />
   <title>Umbrixia | Dashboard</title>
   <link rel="stylesheet" href="styles.css" />
   <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
   <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-auth-compat.js"></script>
   <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore-compat.js"></script>
 
 
 
 
   <style>
     body {
       margin: 0;
       font-family: 'Inter', sans-serif;
       background-color: #0d0d0d;
       color: white;
     }
     .dashboard {
       padding: 60px 20px;
       max-width: 1200px;
       margin: auto;
     }
     h1 {
       font-size: 2.8rem;
       text-align: center;
       color: #ff4d4d;
       margin-bottom: 10px;
     }
     .sub {
       text-align: center;
       font-size: 1.1rem;
       color: #999;
       margin-bottom: 40px;
     }
     .test-buttons {
       display: flex;
       justify-content: center;
       gap: 20px;
       flex-wrap: wrap;
       margin-bottom: 40px;
     }
     .test-buttons button {
       background-color: #111;
       border: 1px solid #ff4d4d;
       padding: 15px 30px;
       font-size: 1rem;
       color: white;
       border-radius: 12px;
       cursor: pointer;
       transition: 0.2s ease;
     }
     .test-buttons button:hover {
       background-color: #ff4d4d;
       color: #0d0d0d;
     }
     .test-section {
       display: none;
       animation: fadeIn 0.4s ease;
     }
     .practice-grid {
       display: grid;
       grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
       gap: 25px;
       margin-bottom: 50px;
     }
     .practice-card {
       background: #111;
       border: 1px solid #222;
       padding: 25px;
       border-radius: 14px;
       box-shadow: 0 0 10px #191919;
       text-align: center;
       transition: 0.2s ease;
     }
     .practice-card:hover {
       box-shadow: 0 0 15px #ff4d4d;
     }
     .practice-card h3 {
       color: #ff4d4d;
     }
     .puzzle-section {
       margin-top: 30px;
       background-color: #141414;
       padding: 20px;
       border-radius: 14px;
       box-shadow: 0 0 8px #181818;
     }
     .puzzle-section h4 {
       color: #ff4d4d;
     }
     @keyframes fadeIn {
       from { opacity: 0; transform: translateY(10px); }
       to { opacity: 1; transform: translateY(0); }
     }
   </style>
   <style>
   #loading-screen {
     position: fixed;
     inset: 0;
     background: #0d0d0d;
     display: flex;
     justify-content: center;
     align-items: center;
     z-index: 9999;
     font-size: 1.5rem;
     color: white;
     font-weight: bold;
     animation: fadeIn 0.3s ease-in-out;
   }
 
     h1 {
   background: linear-gradient(90deg, #ff4d4d, #ff9900, #4caf50, #2196f3, #9c27b0);
   -webkit-background-clip: text;
   color: transparent;
   font-weight: 800;
 }
 
 </style>
 
   <style>
   #universal-loader {
     position: fixed;
     inset: 0;
     background: #0d0d0d;
     z-index: 9999;
     display: flex;
     flex-direction: column;
     justify-content: center;
     align-items: center;
     animation: fadeIn 0.4s ease-in-out;
   }
 
   .spinner {
     border: 5px solid #333;
     border-top: 5px solid #ff4d4d;
     border-radius: 50%;
     width: 60px;
     height: 60px;
     animation: spin 1s linear infinite;
     margin-bottom: 16px;
   }
 
   @keyframes spin {
     to { transform: rotate(360deg); }
   }
 
 
 </style>
 
 
 
 </head>
 
   <!-- Apple-Style Navbar -->
 <header class="umbrixia-header">
   <div class="umbrixia-navbar">
     <div class="logo-area"><a href="/">Umbrixia</a></div>
     <nav class="nav-links">
       <a href="#why-umbrixia-apple">Features</a>
       <a href="signup.html">Free Demo</a>
      <a href="dashboard.html">Dashboard</a>
     </nav>
     <div class="nav-actions">
       <a href="login.html" class="btn-link">Login</a>
       <a href="signup.html" class="btn-solid">Get Started</a>
       <button onclick="toggleTheme()" class="theme-toggle">üåô</button>
     </div>
     <div class="profile-icon" onclick="toggleProfileMenu()">üë§</div>
 <div id="profileMenu" class="profile-menu">
   <p id="userEmailDisplay">Loading...</p>
   <a href="settings.html">‚öôÔ∏è Settings</a>
   <button onclick="logout()">üö™ Logout</button>
 </div>
 
   </div>
 </header>
 
   <body class="dashboard-body">
   <div id="universal-loader">
   <div class="spinner"></div>
   <p style="color: white;">Loading Umbrixia...</p>
 </div>
 
 
 
 
   <div class="dashboard">
     <h1>üß† Umbrixia AI Dashboard</h1>
     <p class="sub">Choose your test, try in-development practice tests, or challenge your mind with puzzles.</p>
     <div id="current-time" style="text-align:center; font-size: 1.1rem; margin-top: -20px; color: #ccc;"></div>
 
     <section class="dashboard-analytics">
   <h2 class="section-title">üìä Performance Trends</h2>
 
 
   <div class="chart-row">
     <!-- Line Chart -->
     <div class="chart-box">
       <canvas id="improvementChart"></canvas>
       <script>
 firebase.auth().onAuthStateChanged(async (user) => {
   if (!user) return;
 
   const scoresRef = db.collection("users").doc(user.uid).collection("scores");
   const snapshot = await scoresRef.orderBy("timestamp", "asc").get();
 
   const mathScores = [];
   const elaScores = [];
   const labels = [];
 
   snapshot.forEach((doc, i) => {
     const data = doc.data();
     labels.push(`Test ${i + 1}`);
     mathScores.push(data.math || 0);
     elaScores.push(data.ela || 0);
   });
 
   if (labels.length === 0) {
   document.querySelector(".dashboard-analytics").innerHTML = `
     <div style="text-align: center; padding: 40px; color: #ccc;">
       <h2>üì≠ No test data found!</h2>
       <p>Let‚Äôs get you started with your first practice test:</p>
       <div style="margin-top: 20px;">
         <button onclick="showSection('shsat')" style="padding: 12px 24px; background-color: #ff4d4d; border: none; color: white; font-size: 1rem; border-radius: 10px; cursor: pointer;">üìù Start SHSAT Test</button>
         <button onclick="showSection('isee')" style="padding: 12px 24px; margin-left: 10px; background-color: #2196f3; border: none; color: white; font-size: 1rem; border-radius: 10px; cursor: pointer;">üìò Start ISEE Test</button>
         <button onclick="showSection('sat')" style="padding: 12px 24px; margin-left: 10px; background-color: #4caf50; border: none; color: white; font-size: 1rem; border-radius: 10px; cursor: pointer;">üéì Start SAT Test</button>
         target.classList.add("active");
       </div>
       
     </div>
   `;
   return;
 }
 
   target.classList.add("active");
 
   new Chart(document.getElementById("improvementChart"), {
     type: "line",
     data: {
       labels,
       datasets: [
         {
           label: "Math",
           data: mathScores,
           borderColor: "#ff4d4d",
           backgroundColor: "rgba(255,77,77,0.2)",
           tension: 0.4,
           fill: true,
           pointRadius: 4
         },
         {
           label: "ELA",
           data: elaScores,
           borderColor: "#ffc107",
           backgroundColor: "rgba(255,193,7,0.2)",
           tension: 0.4,
           fill: true,
           pointRadius: 4
         }
       ]
     },
     options: {
       responsive: true,
       plugins: {
         legend: { position: "top" },
         title: {
           display: true,
           text: "üìà Real Score Improvement",
           font: { size: 18 }
         }
       }
     }
   });
 
   // Pie chart
   const last = snapshot.docs[snapshot.docs.length - 1]?.data();
   const topicData = last?.topics || {
     Algebra: 20,
     Reading: 20,
     Vocabulary: 20,
     Probability: 20,
     Geometry: 20
   };
 
   new Chart(document.getElementById("categoryPieChart"), {
     type: "pie",
     data: {
       labels: Object.keys(topicData),
       datasets: [{
         data: Object.values(topicData),
         backgroundColor: ["#ff4d4d", "#ffc107", "#4caf50", "#2196f3", "#9c27b0"],
         borderColor: "#111"
       }]
     },
     options: {
       plugins: {
         title: {
           display: true,
           text: "üß† Topic Strength Breakdown",
           font: { size: 18 }
         }
       }
     }
   });
 
 });
 </script>
 
       
 
     </div>
 
     <!-- Pie Chart -->
     <div class="chart-box">
       <canvas id="categoryPieChart"></canvas>
     </div>
   </div>
 
       <div class="ai-predictor">
   <h2>üéì AI Admissions Predictor</h2>
   <input id="dream-school" placeholder="Dream School (e.g. Harvard)" />
   <select id="user-grade">
     <option value="6">6th Grade</option>
     <option value="7">7th Grade</option>
     <option value="8">8th Grade</option>
     <option value="9">9th Grade</option>
     <option value="10">10th Grade</option>
     <option value="11">11th Grade</option>
     <option value="12">12th Grade</option>
   </select>
   <button onclick="runPrediction()">üîÆ Predict</button>
 
   <div id="prediction-output" style="margin-top: 1em;">
     <p id="chance"></p>
     <p id="justification"></p>
     <p id="suggestion"></p>
   </div>
 </div>
 
 
   <div class="predictor-estimate">
     <h3>üéØ College Predictor</h3>
     <p>Your estimated chance of admission to your dream school is:</p>
     <div id="admissionScore" class="gradient-score">Calculating...</div>
   </div>
 </section>
 
 
     <div class="test-buttons">
       <button onclick="showSection('shsat')">SHSAT</button>
       <button onclick="showSection('isee')">ISEE</button>
       <button onclick="showSection('sat')">SAT</button>
     </div>
 
     <!-- SHSAT Section -->
     <div id="shsat" class="test-section">
       <h2>SHSAT Practice Tests</h2>
       <div class="practice-grid">
         <div class="practice-card"><h3>Test 1</h3><p>Coming Soon...</p></div>
         <button onclick="markTestComplete()">Start Test</button>
         <div class="practice-card"><h3>Test 2</h3><p>Coming Soon...</p></div>
         <button onclick="markTestComplete()">Start Test</button>
         <div class="practice-card"><h3>Test 3</h3><p>Coming Soon...</p></div>
         <button onclick="markTestComplete()">Start Test</button>
       </div>
       <div class="puzzle-section">
         <h4>üß© SHSAT Puzzle of the Day</h4>
         <p>‚ÄúYou measure my life in hours and I serve you by expiring. I‚Äôm quick when I‚Äôm thin and slow when I‚Äôm fat. The wind is my enemy.‚Äù</p>
         <small>Answer tomorrow.</small>
       </div>
     </div>
 
     <!-- ISEE Section -->
     <div id="isee" class="test-section">
       <h2>ISEE Practice Tests</h2>
       <div class="practice-grid">
         <div class="practice-card"><h3>Test 1</h3><p>Coming Soon...</p></div>
         <div class="practice-card"><h3>Test 2</h3><p>Coming Soon...</p></div>
         <div class="practice-card"><h3>Test 3</h3><p>Coming Soon...</p></div>
       </div>
       <div class="puzzle-section">
         <h4>üß† ISEE Logic Puzzle</h4>
         <p>‚ÄúI speak without a mouth and hear without ears. I have no body, but I come alive with wind.‚Äù</p>
         <small>Answer tomorrow.</small>
       </div>
     </div>
 
     <!-- SAT Section -->
     <div id="sat" class="test-section">
       <h2>SAT Practice Tests</h2>
       <div class="practice-grid">
         <div class="practice-card"><h3>Test 1</h3><p>Coming Soon...</p></div>
         <div class="practice-card"><h3>Test 2</h3><p>Coming Soon...</p></div>
         <div class="practice-card"><h3>Test 3</h3><p>Coming Soon...</p></div>
       </div>
       <div class="puzzle-section">
         <h4>üí° SAT Puzzle</h4>
         <p>‚ÄúI have keys but no locks. I have space but no room. You can enter but you can‚Äôt go outside. What am I?‚Äù</p>
         <small>Answer tomorrow.</small>
       </div>
     </div>
   </div>
 
   <script>
 function showSection(testId) {
   document.querySelectorAll('.test-section').forEach(section => {
     section.classList.remove('active');
     section.style.display = 'none';
   });
 
   const target = document.getElementById(testId);
   target.style.display = 'block';
 
   // Force reflow to allow animation on re-show
   void target.offsetWidth;
 
   target.classList.add('active');
 }
 </script>
 
 
 
   <section class="ai-predictor-box">
   <h2 class="section-title gradient">üéØ College or School Predictor</h2>
   <label>Grade Level:</label>
   <select id="userGrade">
     <option value="8">8th</option>
     <option value="9">9th</option>
     <option value="12">12th</option>
   </select>
 
   <label>Your Dream School:</label>
   <input type="text" id="dreamSchool" placeholder="e.g., Stuyvesant, Harvard, etc." />
 
   <button class="btn-primary" onclick="runAIPrediction()">Generate Prediction</button>
 
   <div id="aiPredictionResult" class="ai-output"></div>
 </section>
 
 
   <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
   <script>
 firebase.auth().onAuthStateChanged(async (user) => {
   if (!user) return;
 
   const db = firebase.firestore();
   const scoresRef = db.collection("users").doc(user.uid).collection("scores");
   const snapshot = await scoresRef.orderBy("timestamp", "asc").get();
 
   const mathScores = [];
   const elaScores = [];
   const labels = [];
 
   snapshot.forEach((doc, i) => {
     const data = doc.data();
     labels.push(`Test ${i + 1}`);
     mathScores.push(data.math || 0);
     elaScores.push(data.ela || 0);
   });
 
   // Fallback if no tests taken
   if (labels.length === 0) {
     labels.push("No data");
     mathScores.push(0);
     elaScores.push(0);
   }
 
   // Draw Line Chart
   new Chart(document.getElementById("improvementChart"), {
     type: "line",
     data: {
       labels,
       datasets: [
         {
           label: "Math",
           data: mathScores,
           borderColor: "#ff4d4d",
           backgroundColor: "rgba(255, 77, 77, 0.2)",
           tension: 0.4,
           fill: true,
           pointRadius: 4
         },
         {
           label: "ELA",
           data: elaScores,
           borderColor: "#ffc107",
           backgroundColor: "rgba(255, 193, 7, 0.2)",
           tension: 0.4,
           fill: true,
           pointRadius: 4
         }
       ]
     },
     options: {
       responsive: true,
       plugins: {
         legend: { position: "top" },
         title: {
           display: true,
           text: "Score Improvement Over Time",
           font: { size: 18 }
         }
       }
     }
   });
 
   // Pie Chart (use last test's topics as placeholder)
   const last = snapshot.docs[snapshot.docs.length - 1]?.data();
   const topicData = last?.topics;
 if (!topicData) {
   console.warn("No topic data found. Skipping pie chart.");
   return;
 }
 
 
   new Chart(document.getElementById("categoryPieChart"), {
     type: "pie",
     data: {
       labels: Object.keys(topicData),
       datasets: [{
         data: Object.values(topicData),
         backgroundColor: ["#ff4d4d", "#ffc107", "#4caf50", "#2196f3", "#9c27b0"],
         borderColor: "#111"
       }]
     },
     options: {
       plugins: {
         title: {
           display: true,
           text: "Topic Strength Distribution",
           font: { size: 18 }
         }
       }
     }
   });
 
 });
 </script>
 
 
 <script>
 async function runPrediction() {
   const school = document.getElementById("dream-school").value;
   const grade = document.getElementById("user-grade").value;
   const email = firebase.auth().currentUser?.email || "unknown@example.com";
   const userId = firebase.auth().currentUser?.uid;
 
   const db = firebase.firestore();
   const userDoc = await db.collection("users").doc(userId).get();
   const hasTakenTest = userDoc.exists && userDoc.data().hasTakenTest;
 
   if (!hasTakenTest) {
     document.getElementById("chance").innerText = "‚ùå You need to complete a practice test first.";
     document.getElementById("justification").innerText = "üìò The AI needs test results to make an accurate prediction.";
     document.getElementById("suggestion").innerText = "üìù Please take a SHSAT, ISEE, or SAT test first.";
     return;
   }
 
   const res = await fetch("https://your-render-url.onrender.com/predict", {
     method: "POST",
     headers: { "Content-Type": "application/json" },
     body: JSON.stringify({ school, grade, email })
   });
 
   const data = await res.json();
 
   document.getElementById("chance").innerText = `üéØ Acceptance Chance: ${data.chance}`;
   document.getElementById("justification").innerText = `üß† Why: ${data.justification}`;
   document.getElementById("suggestion").innerText = `üìà Focus On: ${data.suggestion}`;
 }
 
 </script>
 
   <script>
   function markTestComplete() {
   const user = firebase.auth().currentUser;
   if (!user) return;
 
   const db = firebase.firestore();
   db.collection("users").doc(user.uid).set({
     hasTakenTest: true
   }, { merge: true });
 }
 
   </script>
   <script src="script.js" defer></script>
 <script>
   const firebaseConfig = {
     apiKey: "AIzaSyDDcAp59mkTutfXgnRIBWpVww3jFyzOtIc",
     authDomain: "umbrixia-d804f.firebaseapp.com",
     projectId: "umbrixia-d804f",
     storageBucket: "umbrixia-d804f.firebasestorage.app",
     messagingSenderId: "532093768601",
     appId: "1:532093768601:web:4e94149269d88213edb908"
   };
 
   if (!firebase.apps.length) {
     firebase.initializeApp(firebaseConfig);
   }
 
   const auth = firebase.auth();
   const db = firebase.firestore();
 </script>
 
 <script>
   window.addEventListener("load", () => {
     const loader = document.getElementById("universal-loader");
     if (loader) loader.style.display = "none";
   });
 </script>
 
 <script>
   const firebaseConfig = {
     apiKey: "AIzaSyDDcAp59mkTutfXgnRIBWpVww3jFyzOtIc",
     authDomain: "umbrixia-d804f.firebaseapp.com",
     projectId: "umbrixia-d804f",
     storageBucket: "umbrixia-d804f.firebasestorage.app",
     messagingSenderId: "532093768601",
     appId: "1:532093768601:web:4e94149269d88213edb908"
   };
 
   if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
   const auth = firebase.auth();
   const db = firebase.firestore();
 
   window.addEventListener("load", () => {
     const universalLoader = document.getElementById("universal-loader");
     const loginScreen = document.getElementById("loading-screen");
 
     auth.onAuthStateChanged((user) => {
       if (!user) {
         window.location.href = "login.html";
       } else {
         if (universalLoader) universalLoader.style.display = "none";
         if (loginScreen) loginScreen.style.display = "none";
 
         const name = user.displayName || user.email.split("@")[0];
         const emailEl = document.getElementById("userEmailDisplay");
         if (emailEl) emailEl.textContent = user.email;
       }
     });
   });
 </script>
 
   <script>
   function toggleProfileMenu() {
     const menu = document.getElementById("profileMenu");
     if (menu.style.display === "block") {
       menu.style.display = "none";
     } else {
       menu.style.display = "block";
     }
   }
 
   function logout() {
     firebase.auth().signOut().then(() => {
       window.location.href = "login.html";
     });
   }
 </script>
 
   <script>
   setInterval(() => {
     const now = new Date();
     document.getElementById("current-time").textContent = now.toLocaleString();
   }, 1000);
 </script>
 
 
 </body>
 </html>
